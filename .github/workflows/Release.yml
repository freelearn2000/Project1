name: Create Release

on:
  workflow_run:
     workflows: ["Nodeapp", "Reactapp"]
     types: [completed]
     branches: [master]
     
jobs:
  release:
    name: Create Release
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v2

    - name: Conditions for Release
      uses: ahmadnassri/action-workflow-run-wait@v1       # only runs additional steps if [ Nodeapp, Reactapp ] were successful
      
    - name: Setup Node.js
      uses: actions/setup-node@v2
      with:
        node-version: '16'
        
    - name: Download from React Artifact
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: Reactapp.yml
        name: React_build
        skip_unpack: true
     
    - name: Download from Node Artifact
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: Nodeapp.yml
        name: Node_build
        skip_unpack: true
     
    - name: Create a Release
      run: npx semantic-release
      env:
         GITHUB_TOKEN: ${{ secrets.SEMANTIC_TOKEN1 }}
         
    
